---
description: Voice Engine Data Protocol. Defines how actor metadata, pricing, and profile data is fetched and handled via Supabase/Drizzle.
globs: ["apps/web/src/app/agency/**/*", "apps/web/src/app/voice/**/*", "apps/web/src/lib/api.ts", "apps/web/src/lib/pricing-engine.ts"]
---

# ðŸŽ™ï¸ VOICE ENGINE DATA: ACTORS, PRICING & PROFILES

Dit protocol definieert hoe stemacteur-data wordt opgehaald, berekend en weergegeven binnen de Native Journey.

---

## 1. DATA SOURCE (UNIFIED DATABASE)
De "Source of Truth" is de Supabase PostgreSQL database via Drizzle ORM. We gebruiken GEEN WordPress Post Meta meer.

### Kern Tabellen:
- `actors`: Basis profiel (namen, gender, native_lang, voice_score, status).
- `actor_demos`: Audio demo's gekoppeld aan de `actors.id`.
- `reviews`: Klantervaringen gekoppeld via `iapContext->'actorId'`.

## 2. PRICING LOGIC (NATIVE ENGINE)
Prijzen worden berekend via de `PricingEngine` (TypeScript) in `src/lib/pricing-engine.ts`.

### Geverifieerde Velden voor Berekening:
- `price_unpaid_media`: Basis voor corporate/e-learning.
- `price_ivr`: Basis voor telefonie.
- `{market}_price_online_media`: Markt-specifiek (bijv. `be_price_online_media`).
- `price_live_regie`: Toeslag voor live regie.

### Reken-regels:
- Gebruik ALTIJD de `PricingEngine.calculatePrice()` methode.
- Bedragen zijn ALTIJD **exclusief BTW**.
- Toon prijzen via de standaard `Intl.NumberFormat('nl-BE')`.

## 3. IMPLEMENTATIE IN NEXT.JS
- **Fetching:** Gebruik `getActor(slug)` of `getActors()` uit `src/lib/api.ts`.
- **Client Components:** Geef de volledige `actor` data door aan de `PricingCalculator`.
- **Context:** Gebruik `data-voices-context="actor-{id}"` op profiel-kaarten voor de Intelligence Layer.

## 4. VAKANTIE & STATUS
- Controleer de `status` kolom (`live` = publiek).
- Respecteer de `availability` JSON kolom voor het tonen van de 'Direct Boeken' knop.

---
**GOUDEN REGEL:** Gok nooit naar tarieven. De `PricingEngine` is de enige die prijzen bepaalt op basis van de database-velden.
