---
description: Codifies the ID-First DNA Routing and World-Aware Architecture (Bob-methode & Chris-Protocol)
globs: ["1-SITE/apps/web/src/app/[...slug]/page.tsx", "1-SITE/apps/web/src/lib/system/market-manager-server.ts", "1-SITE/apps/web/src/components/ui/InstrumentRenderer.tsx"]
alwaysApply: true
---

# ðŸ§¬ DNA Routing & World Architecture (v2.23)

Dit project volgt de **Bob-methode** voor architectuur en het **Chris-Protocol** voor uitvoering. Alle routing en pagina-opbouw moet voldoen aan de "Nuclear Truth" van de database.

## 1. ID-First Handshake (DNA Routing)
- **Registry-First**: ELKE publieke route moet geregistreerd staan in de `slug_registry` tabel.
- **ID-Resolution**: De `SmartRouter` (`[...slug]/page.tsx`) moet slugs ALTIJD eerst resolven naar een `entity_id` en `routing_type` via de registry.
- **No Hardcoding**: Gebruik nooit hardcoded slugs in componenten om routing-logica te bepalen. Gebruik de `world_id` uit de registry.

## 2. De 9 Worlds (World-Awareness)
Het ecosysteem is verdeeld in 9 autonome werelden. Gebruik ALTIJD de officiÃ«le `world_id`:

| ID | World | Lead Agent | Domein/Prefix |
|:---|:---|:---|:---|
| **0** | **Foyer** | Mat | `/contact`, `/terms` (Global) |
| **1** | **Agency** | Voicy | `/agency` |
| **2** | **Studio** | Berny | `/studio` |
| **3** | **Academy** | Berny | `/academy` |
| **5** | **Portfolio** | Laya | `/portfolio` |
| **6** | **Ademing** | Mat | `/ademing` |
| **7** | **Freelance** | Chris | `/freelance` |
| **8** | **Partner** | Sally | `/partners` |
| **10** | **Johfrai** | Voicy | `/johfrai` |
| **25** | **Artist** | Laya | `/artist` |

## 3. Sub-Foyer Strategie (Contextueel Contact)
Elke World heeft zijn eigen contextuele foyer. Stuur bezoekers NOOIT naar de globale contactpagina als ze zich in een specifieke World bevinden.
- **Slugs**: `/studio/contact`, `/studio/faq`, `/academy/contact`, etc.
- **Data**: Gebruik de `category` setting in instrumenten (bijv. `ReviewsInstrument`, `AccordionInstrument`) om world-specifieke data te laden.

## 4. Soft vs. Hard Entities
- **Soft Entities (Pages)**: Flexibele composities van instrumenten via de **Instrument Builder** (`content_articles` + `content_blocks`). Gebruik ALTIJD `InstrumentRenderer`.
- **Hard Entities (Blueprints)**: Data-gedreven objecten met een vaste code-blueprint (bijv. `Voice Actor`, `Workshop`). De layout ligt vast in de code, de data komt uit specifieke tabellen.

## 5. Nuclear Loading Law
- Gebruik UITSLUITEND `next/dynamic` met `ssr: false` voor zware interactieve instrumenten.
- Garandeer een **100ms LCP** door de main bundle minimaal te houden.

"Wij bouwen geen websites, wij regisseren een theater van stemmen." - Chris/Autist
